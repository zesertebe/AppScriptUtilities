class AppScriptUtilities{static convertStringToDate(e){if("string"!=typeof e)return{status:!1,content:'El argumento "str" debe ser una cadena de texto'};let t="",n=e.split(" ");if(n.length>=3&&3===n[0].split("/").length&&4===n[0].split("/")[2].length){let a=n[0].split("/");t=`${a[2]}/${a[1]}/${a[0]} ${n[1]} ${n[2]}`}return{status:!0,content:new Date(t)}}static getHolidays(){let e=[{fecha:"01/01",proximoLunes:!1,nombre:"A\xf1o Nuevo"},{fecha:"01/06",proximoLunes:!0,nombre:"D\xeda de los Reyes Magos"},{fecha:"03/19",proximoLunes:!0,nombre:"D\xeda de San Jos\xe9"},{diasParaSumar:-3,proximoLunes:!1,nombre:"Jueves Santo"},{diasParaSumar:-2,proximoLunes:!1,nombre:"Viernes Santo"},{fecha:"05/01",proximoLunes:!1,nombre:"D\xeda del Trabajo"},{diasParaSumar:40,proximoLunes:!0,nombre:"Ascensi\xf3n del Se\xf1or"},{diasParaSumar:60,proximoLunes:!0,nombre:"Corphus Christi"},{diasParaSumar:71,proximoLunes:!0,nombre:"Sagrado Coraz\xf3n de Jes\xfas"},{fecha:"06/29",proximoLunes:!0,nombre:"San Pedro y San Pablo"},{fecha:"07/20",proximoLunes:!1,nombre:"D\xeda de la Independencia"},{fecha:"08/07",proximoLunes:!1,nombre:"Batalla de Boyac\xe1"},{fecha:"08/15",proximoLunes:!0,nombre:"La Asunci\xf3n de la Virgen"},{fecha:"10/12",proximoLunes:!0,nombre:"D\xeda de la Raza"},{fecha:"11/01",proximoLunes:!0,nombre:"Todos los Santos"},{fecha:"11/11",proximoLunes:!0,nombre:"Independencia de Cartagena"},{fecha:"12/08",proximoLunes:!1,nombre:"D\xeda de la Inmaculada Concepci\xf3n"},{fecha:"12/25",proximoLunes:!1,nombre:"D\xeda de Navidad"}],t=e=>e<10?"0"+e:e,n=e=>t(e.getDate())+"/"+t(e.getMonth()+1)+"/"+e.getFullYear(),a=e=>{let n=(19*(e%19)+24)%30,a=22+n+(2*(e%4)+4*(e%7)+6*n+5)%7;return new Date(a>=1&&a<=31?`03/${t(a)}/${e}`:`04/${t(a-31)}/${e}`)},r=e=>{for(;1!==e.getDay();)e.setDate(e.getDate()+1);return e},s=(e,t)=>{let n=new Date(e);return n.setDate(n.getDate()+t),n},o=t=>{let o=[],i=a(t),u;return e.forEach(e=>{u=e.diasParaSumar?s(i.toDateString(),e.diasParaSumar):new Date(e.fecha+"/"+t),e.proximoLunes&&(u=r(u)),o.push({fecha:n(u),nombre:e.nombre,estatico:e.proximoLunes})}),o},i=(t,o)=>{let i=[],u,c,l;for(let d=t;d<o;d++)u={year:d,festivos:[]},c=a(d),e.forEach(e=>{l=e.diasParaSumar?s(c.toDateString(),e.diasParaSumar):new Date(e.fecha+"/"+d),e.proximoLunes&&(l=r(l)),u.festivos.push({fecha:n(l),nombre:e.nombre,estatico:e.proximoLunes})}),i.push(u);return i};return Object.freeze({getHolidaysByYear:o,getHolidaysByYearInterval:i})}static flowFunctions(e){return(...t)=>e.reduce((e,t)=>[t(...e)],t)[0]}static joinObjects(...e){return{status:!0,content:e.reverse().reduce((e,t)=>({...e,...t}),{})}}static partialFunction(e,...t){return[null,void 0,""].includes(e)?{status:!1,content:'El argumento "func" no puede estar vac\xedo'}:"function"!=typeof val?{status:!1,content:'El argumento "func" debe ser una funcion '}:{status:!0,content:(...n)=>e(...t,...n)}}static convertRowsToColumns(e,...t){return Array.isArray(e)?e&&e.length?{status:!0,content:e.map((e,n)=>[e,...t.map(e=>e[n])])}:{status:!0,content:[]}:{status:!1,content:'El tipo de dato "arr" debe ser un arreglo'}}static splitArray(e,t=1){if(!Array.isArray(e))return{status:!1,content:'El tipo de dato "arr" debe ser un arreglo'};if(isNaN(t))return{status:!1,content:'El tipo de dato "size" debe ser un numero'};let n=[...e],a=[];if(t<=0)return a;for(;n.length;)a.push(n.splice(0,t));return{status:!0,content:a}}static capitalizeString(e){return"string"!=typeof e?{status:!1,content:'El argumento "str" debe ser un cadena de texto'}:e.length?{status:!0,content:(e=e[0].toUpperCase()+e.slice(1).toLowerCase()).split("").map((t,n)=>void 0!=e[n-1]&&[" ","."].includes(e[n-1])?t.toUpperCase():t).join("")}:{status:!1,content:""}}static convertExcelToSheets(e,t){if("string"!=typeof e)return{status:!1,content:'El argumento "ExcelId" debe ser un cadena de texto'};if("string"!=typeof t)return{status:!1,content:'El argumento "FolderTargetId" debe ser un cadena de texto'};if(!e.length||!t.length)return{status:!1,content:""};let n=DriveApp.getFileById(e);return{status:!0,content:Drive.Files.insert({title:`_CONVERTED_${n.getName().split(".")[0]}`,parents:[{id:t}]},n.getBlob(),{convert:!0,supportsAllDrives:!0}).getId()}}static countNumbersAndLettersFromString(e){if("string"!=typeof e)return{status:!1,content:'El argumento "str" debe ser un cadena de texto'};let t=RegExp("\\d","g"),n=0;for(;t.exec(e);)n++;return{status:!0,content:{letters:e.length-n,numbers:n}}}static checkTypeSheet(e){if("string"!=typeof e)return{status:!1,content:'El argumento "id" debe ser un cadena de texto'};if(!e.length)return{status:!1,content:!1};let t=DriveApp.getFileById(e),n=!1;return"application/vnd.google-apps.spreadsheet"==t.getMimeType()&&(n=!0),{status:n,content:n}}static isValidURL(e){return"string"!=typeof e?{status:!1,content:'El argumento "str" debe ser un cadena de texto'}:{status:!0,content:!!RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_=]*)?$","i").test(e)}}static createPDFFromBase64({baseData:e="",namePdf:t="",folderId:n=""}){if("string"!=typeof e)return{status:!1,content:'El argumento "baseData" debe ser un cadena de texto'};if("string"!=typeof t)return{status:!1,content:'El argumento "namePdf" debe ser un cadena de texto'};if("string"!=typeof n)return{status:!1,content:'El argumento "folderId" debe ser un cadena de texto'};if(!e.length||!t.length||!n.length)return{status:!1,content:""};let a=Utilities.newBlob(Utilities.base64Decode(e),"application/pdf",t);a.setContentType("application/pdf");let r=DriveApp.getFolderById(n).createFile(a);return{status:!0,content:r.getUrl(),handler:r.getAs(MimeType.PDF)}}static checkEmail(e){return"string"!=typeof e?{status:!1,content:'El argumento "email" debe ser un cadena de texto'}:{status:!0,content:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+.[a-zA-Z0-9]*$/.test(e)}}static addFileToFront(e){return HtmlService.createTemplateFromFile(e).evaluate().getContent()}static getRowColumnNumberByA1Notation(e){if("string"!=typeof e)return{status:!1,content:'El argumento "cell" debe ser un cadena de texto'};let t=e.match(/[A-Za-z]*/g).filter(e=>""!=e)[0],n=e.match(/[0-9]*/g).filter(e=>""!=e)[0];return void 0==t||void 0==n?{status:!1,content:"Datos incorrectos"}:{status:!0,content:{numbers:parseInt(n),letters:this.getColumnByA1Notation(t).content}}}static acercaDe(){return{author:"Arturo Gomez => zesertebe@gmail.com",description:`Clase dise\xf1ada para proporcionar utilidades que solucionan problemas comunes`,web:"https://ocancelada.dev"}}static getLetterByNumber(e){return isNaN(e)||e<=0?{status:!1,content:'El argumento "index" debe ser un n\xfamero positivo mayor a 0'}:{status:!0,content:e<=26?String.fromCharCode(e+64):String.fromCharCode(64+parseInt(e/26))+String.fromCharCode(64+(e-26*parseInt(e/26)))}}static getColumnByA1Notation(e){return"string"!=typeof e?{status:!1,content:'El argumento "index" debe ser un cadena de texto'}:(e=e.toUpperCase().match(/[A-Z]*/g).filter(e=>""!=e).join("")).length?{status:!0,content:1===e.length?e.charCodeAt(0)-64:e.split("").slice(0,2).reduce((e,t)=>(e.charCodeAt(0)-64)*26+(t.charCodeAt(0)-64))}:{status:!1,content:""}}static getIdFromUrl(e){if("string"!=typeof e)return{status:!1,content:'El argumento "url" debe ser un cadena de texto'};let t=e.match(/[-\w]{25,}/);return null===t?{status:!1,content:"No se encontr\xf3 un id v\xe1lido"}:{status:!0,content:t[0]}}static makeid(e=2){if("number"!=typeof e)return{status:!1,content:'El argumento "length" debe ser un numero'};e<0&&(e*=-1),0===e&&(e=1);let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length;for(let r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return{status:!0,content:t}}static getBase64ImgAsBlob({base64:e,nameOfImage:t}){if("string"!=typeof e)return{status:!1,content:'El argumento "base64" debe ser un cadena de texto'};if(!e.length)return{status:!1,content:""};null===t&&(t="img_"+this.makeid(5));let n=Utilities.base64Decode(e);return{status:!0,content:Utilities.newBlob(n,MimeType.JPEG,t)}}static sendEmail({emailto:e,subject:t,from:n,bodymsg:a,attachments:r,img:s=null,cc:o=""}){let i="";if("string"!=typeof e)return{status:!1,content:'El argumento "emailto" debe ser un cadena de texto'};if(""!==e){let u={htmlBody:a,cc:o};if(null!=s){let c=[...a.matchAll("<img")],l=0,d=0,m="",g={},p="",$="";c.forEach((e,t)=>{if(l=a.slice(e.index,a.length-1).search('src="')+5+e.index,p+=a.slice(d,l),d=a.slice(l,a.length-1).search('"')+l,m=a.slice(l,d).split(",")[1],!($=this.getBase64ImgAsBlob({base64:m})).status)return $;""!=$.content?(g["img_"+t]=$.content,p+="cid:img_"+t):p+=m}),p+=a.slice(d,a.length),a="",a+=p,p="",d=0,(c=[...a.matchAll("background-image:")]).forEach((e,t)=>{if(l=a.slice(e.index,a.length-1).search("url\\('")+5+e.index,p+=a.slice(d,l),d=a.slice(l,a.length-1).search("'")+l,m=a.slice(l,d).split(",")[1],!($=this.getBase64ImgAsBlob({base64:m})).status)return $;""!=$.content?(g["backImg_"+t]=$.content,p+="cid:backImg_"+t):p+=m}),p+=a.slice(d,a.length),u.htmlBody=p,u.inlineImages=g}null!=r&&(u.attachments=r),null!=n&&(u.from=n),i=GmailApp.sendEmail(e,t,"",u)}return{status:!0,content:i}}}