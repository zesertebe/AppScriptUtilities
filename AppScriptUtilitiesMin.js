class AppScriptUtilities{static getNumberFromStr(e){if("string"!=typeof e||e.trim().length<1)throw Error('El argumento "str" debe ser una cadena de texto no vac\xeda');let t=e.match(/[0-9]+/g);if(!t)throw Error("La cadena no contiene n\xfameros");return parseInt(t.join(""))}static createDateFromString(e,t){if("string"!=typeof e||e.trim().length<1)throw Error('El argumento "str" debe ser una cadena de texto no vac\xeda');if("string"!=typeof t||t.trim().length<5)throw Error('El argumento "format" debe ser una cadena de texto no vac\xeda');let r=t.toUpperCase().split(/[-/.]/),a=e.split(/[-/.]/);if(3!==r.length||3!==a.length)throw Error("El formato o el string son inv\xe1lidos");let o=r.includes("YYYY")?r.indexOf("YYYY"):r.indexOf("YY"),n=r.indexOf("MM"),i=r.indexOf("DD");if(-1===o||-1===n||-1===i)throw Error("El formato es inv\xe1lido");let s=parseInt(a[o]),l=parseInt(a[n])-1,c=parseInt(a[i]),d=new Date(s,l,c);if(isNaN(d.getTime()))throw Error("La fecha es inv\xe1lida");return d}static getHolidays(){let e=[{fecha:"01/01",proximoLunes:!1,nombre:"A\xf1o Nuevo"},{fecha:"01/06",proximoLunes:!0,nombre:"D\xeda de los Reyes Magos"},{fecha:"03/19",proximoLunes:!0,nombre:"D\xeda de San Jos\xe9"},{diasParaSumar:-3,proximoLunes:!1,nombre:"Jueves Santo"},{diasParaSumar:-2,proximoLunes:!1,nombre:"Viernes Santo"},{fecha:"05/01",proximoLunes:!1,nombre:"D\xeda del Trabajo"},{diasParaSumar:40,proximoLunes:!0,nombre:"Ascensi\xf3n del Se\xf1or"},{diasParaSumar:60,proximoLunes:!0,nombre:"Corphus Christi"},{diasParaSumar:71,proximoLunes:!0,nombre:"Sagrado Coraz\xf3n de Jes\xfas"},{fecha:"06/29",proximoLunes:!0,nombre:"San Pedro y San Pablo"},{fecha:"07/20",proximoLunes:!1,nombre:"D\xeda de la Independencia"},{fecha:"08/07",proximoLunes:!1,nombre:"Batalla de Boyac\xe1"},{fecha:"08/15",proximoLunes:!0,nombre:"La Asunci\xf3n de la Virgen"},{fecha:"10/12",proximoLunes:!0,nombre:"D\xeda de la Raza"},{fecha:"11/01",proximoLunes:!0,nombre:"Todos los Santos"},{fecha:"11/11",proximoLunes:!0,nombre:"Independencia de Cartagena"},{fecha:"12/08",proximoLunes:!1,nombre:"D\xeda de la Inmaculada Concepci\xf3n"},{fecha:"12/25",proximoLunes:!1,nombre:"D\xeda de Navidad"}],t=e=>e<10?"0"+e:e,r=e=>t(e.getDate())+"/"+t(e.getMonth()+1)+"/"+e.getFullYear(),a=e=>{let r=(19*(e%19)+24)%30,a=22+r+(2*(e%4)+4*(e%7)+6*r+5)%7;return new Date(a>=1&&a<=31?`03/${t(a)}/${e}`:`04/${t(a-31)}/${e}`)},o=e=>{for(;1!==e.getDay();)e.setDate(e.getDate()+1);return e},n=(e,t)=>{let r=new Date(e);return r.setDate(r.getDate()+t),r},i=t=>{let i=[],s=a(t),l;return e.forEach(e=>{l=e.diasParaSumar?n(s.toDateString(),e.diasParaSumar):new Date(e.fecha+"/"+t),e.proximoLunes&&(l=o(l)),i.push({fecha:r(l),nombre:e.nombre,estatico:e.proximoLunes})}),i},s=(t,i)=>{let s=[],l,c,d;for(let u=t;u<i;u++)l={year:u,festivos:[]},c=a(u),e.forEach(e=>{d=e.diasParaSumar?n(c.toDateString(),e.diasParaSumar):new Date(e.fecha+"/"+u),e.proximoLunes&&(d=o(d)),l.festivos.push({fecha:r(d),nombre:e.nombre,estatico:e.proximoLunes})}),s.push(l);return s};return Object.freeze({getHolidaysByYear:i,getHolidaysByYearInterval:s})}static flowFunctions(e){if(!Array.isArray(e)||!e.every(e=>"function"==typeof e))throw Error('Todos los elementos de "funcs" deben ser funciones');return(...t)=>{try{return e.reduce((e,t)=>[t(...e)],t)[0]}catch(r){throw console.error("Error al ejecutar una de las funciones:",r),r}}}static joinObjects(...e){return e.reduce((e,t)=>{if("object"==typeof t&&null!==t)for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},{})}static partial(e,...t){if("function"!=typeof e)throw Error("El primer argumento debe ser una funci\xf3n.");return(...r)=>e(...t,...r)}static convertRowsToColumns(e,...t){if(!Array.isArray(e)||!t.every(Array.isArray))throw Error("Todos los argumentos deben ser arreglos.");let r=Math.max(e.length,...t.map(e=>e.length));return Array.from({length:r}).map((r,a)=>[e[a],...t.map(e=>e[a])])}static splitArray(e,t=1){if(!Array.isArray(e))throw Error('El tipo de dato "arr" debe ser un arreglo');if("number"!=typeof t||t<=0||!Number.isInteger(t))throw Error('El tipo de dato "size" debe ser un n\xfamero entero positivo');let r=[];for(let a=0;a<e.length;a+=t)r.push(e.slice(a,a+t));return r}static capitalizeString(e){if("string"!=typeof e||!e.trim().length)throw Error('El argumento "str" debe ser un cadena de texto no vac\xeda');return e.toLowerCase().replace(/(^|\s|\.)([a-z])/g,(e,t,r)=>t+r.toUpperCase())}static convertExcelToSheets(e,t){if(!e||"string"!=typeof e||!t||"string"!=typeof t)throw Error('Los argumentos "excelId" y "folderTargetId" deben ser cadenas de texto no vac\xedas.');try{let r=DriveApp.getFileById(e),a=Drive.Files.insert({title:`_CONVERTED_${r.getName().split(".")[0]}`,parents:[{id:t}]},r.getBlob(),{convert:!0,supportsAllDrives:!0});return a.getId()}catch(o){throw Error(`Error al convertir el archivo: ${o.message}`)}}static countNumbersAndLettersFromString(e){if("string"!=typeof e)throw Error('El argumento "str" debe ser una cadena de texto.');let t=e.match(/\d/g)||[],r=e.match(/[a-zA-Z]/g)||[];return{lettersCount:r.length,numbersCount:t.length}}static checkTypeSheet(e){if("string"!=typeof e||!e.trim())throw Error('El argumento "id" debe ser una cadena de texto no vac\xeda.');try{let t=DriveApp.getFileById(e);return"application/vnd.google-apps.spreadsheet"===t.getMimeType()}catch(r){throw Error(`Error al obtener el archivo: ${r.message}`)}}static isValidURL(e){if("string"!=typeof e)throw Error('El argumento "str" debe ser un cadena de texto');return!!RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_=]*)?$","i").test(e)}static createPDFFromBase64(e="",t="",r=""){if(!e||"string"!=typeof e)throw Error('El argumento "baseData" debe ser una cadena de texto no vac\xeda.');if(!t||"string"!=typeof t)throw Error('El argumento "namePdf" debe ser una cadena de texto no vac\xeda.');if(!r||"string"!=typeof r)throw Error('El argumento "folderId" debe ser una cadena de texto no vac\xeda.');try{let a=Utilities.newBlob(Utilities.base64Decode(e),"application/pdf",t),o=DriveApp.getFolderById(r).createFile(a);return o.getId()}catch(n){throw Error(`Error al crear el archivo PDF: ${n.message}`)}}static checkEmail(e){if("string"!=typeof e||!e.trim().length)throw Error('El parametro "email" debe ser un string no vac\xedo');return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+.[a-zA-Z0-9]*$/.test(e)}static addFileToFront(e){if("string"!=typeof fileName||!fileName.trim())throw Error('El par\xe1metro "fileName" debe ser un string no vac\xedo');let t=HtmlService.createTemplateFromFile(fileName);if(!t)throw Error("No se pudo crear una plantilla HTML a partir del archivo especificado");return t.evaluate().getContent()}static getRowColumnNumberByA1Notation(e){if("string"!=typeof e||!e.trim())throw Error('El argumento "cell" debe ser una cadena de texto no vac\xeda.');let t=e.match(/[A-Za-z]+/),r=e.match(/\d+/);if(!t||!r)throw Error("No se pudo obtener la fila o la columna.");return{row:parseInt(r[0],10),column:this.getColumnByA1Notation(t[0])}}static acercaDe(){return{author:"Arturo Gomez => zesertebe@gmail.com",description:`Clase dise\xf1ada para proporcionar utilidades que solucionan problemas comunes`,web:"https://adev.dev"}}static getLetterByNumber(e){if(isNaN(e)||e<=0)throw Error('El argumento "index" debe ser un n\xfamero positivo mayor a 0');let t="";for(;e>0;){let r=(e-1)%26;t=String.fromCharCode(65+r)+t,e=Math.floor((e-1)/26)}return t}static getColumnByA1Notation(e){if("string"!=typeof e||!e.trim().length)throw Error('El argumento "index" debe ser un cadena de texto no vac\xeda');if(!(e=e.toUpperCase().match(/[A-Z]*/g).filter(e=>""!=e).join("")).length)return"";let t=1===e.length?e.charCodeAt(0)-64:e.slice(0,2).split("").reduce((e,t)=>(e.charCodeAt(0)-64)*26+(t.charCodeAt(0)-64));if(t>702)throw RangeError("El valor de la columna en notaci\xf3n A1 es mayor a la columna ZZ.");return t}static getIdFromUrl(e){if("string"!=typeof e||!e.length)throw Error('El argumento "url" debe ser un cadena de texto no vac\xeda');let t=e.match(/[-\w]{25,}/);if(null===t)throw Error("No se pudo encontrar un ID v\xe1lido en la URL");return t[0]}static makeid(e=2){if("number"!=typeof e||e<=0||!Number.isInteger(e))throw Error('El argumento "length" debe ser un n\xfamero positivo entero');let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=r.length;for(let o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*a));return t}static getBase64ImgAsBlob(e,t){if("string"!=typeof e||!e.length)throw Error('El argumento "base64" debe ser un cadena de texto no vac\xeda');("string"!=typeof t||""===t.trim())&&(t="img_"+this.makeid(5));let r=Utilities.base64Decode(e);return Utilities.newBlob(r,MimeType.JPEG,t)}static sendEmail({emailto:e,subject:t,from:r,bodymsg:a,attachments:o,img:n=null,cc:i=""}){if("string"!=typeof e||""===e.trim())throw Error('El argumento "emailto" debe ser una cadena de texto no vac\xeda');let s=!1;if("string"!=typeof e)throw Error('El argumento "emailto" debe ser un cadena de texto no vac\xeda');let l={htmlBody:a,cc:i};if(null!=n){let c=[...a.matchAll("<img")],d=0,u=0,m="",g={},h="",f="";c.forEach((e,t)=>{if(d=a.slice(e.index,a.length-1).search('src="')+5+e.index,h+=a.slice(u,d),u=a.slice(d,a.length-1).search('"')+d,m=a.slice(d,u).split(",")[1],!(f=this.getBase64ImgAsBlob({base64:m})).status)return f;""!=f.content?(g["img_"+t]=f.content,h+="cid:img_"+t):h+=m}),h+=a.slice(u,a.length),a="",a+=h,h="",u=0,(c=[...a.matchAll("background-image:")]).forEach((e,t)=>{if(d=a.slice(e.index,a.length-1).search("url\\('")+5+e.index,h+=a.slice(u,d),u=a.slice(d,a.length-1).search("'")+d,m=a.slice(d,u).split(",")[1],!(f=this.getBase64ImgAsBlob({base64:m})).status)return f;""!=f.content?(g["backImg_"+t]=f.content,h+="cid:backImg_"+t):h+=m}),h+=a.slice(u,a.length),l.htmlBody=h,l.inlineImages=g}return null!=o&&(l.attachments=o),null!=r&&(l.from=r),!!(s=GmailApp.sendEmail(e,t,"",l))}}
